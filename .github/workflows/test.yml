name: Test

on:
  push:

jobs:
  Variables:
    # What a dumb jobs this is
    # Needed because of https://github.com/orgs/community/discussions/26671
    # Ideally want to be able to use:
    # with:
    #    NAME: ${{ env.NAME }}
    # in the Call-RPM-Build job but the above issue prevents it
    name: Compute outputs
    runs-on: ubuntu-latest
    env:
      # see https://github.com/organizations/daos-stack/settings/variables/actions for
      # the organizational defaults values for these variables
      # TODO: we really need to define a list of supported versions (ideally it's no more than 2)
      #       build is done on the lowest version and test on the highest with a "sanity test"
      #       stage done on all versions in the list ecept the highest
      Variable: ${{ vars.Variable }}
    outputs:
      Variable: ${{ env.Variable }}

  Call-RPM-Build:
    name: Build RPM
    needs: Variables
    env:
      Variable: ${{ needs.Variables.outputs.Variable }}
    steps:
      - run: |
        echo $Variable
